<!DOCTYPE html>
<html class="light" lang="es">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Mis Actividades - Sistema de Lectura IA</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined"
      rel="stylesheet"
    />
    <script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: "#4396ea",
              "background-light": "#f6f7f8",
              "background-dark": "#111921",
            },
            fontFamily: {
              display: ["Inter", "sans-serif"],
            },
            borderRadius: {
              DEFAULT: "0.25rem",
              lg: "0.5rem",
              xl: "0.75rem",
              full: "9999px",
            },
          },
        },
      };
    </script>
    <link rel="stylesheet" href="/css/main.css" />
    <script src="/js/tabs_actividades.js" defer></script>
  </head>

  <body
    class="bg-background-light dark:bg-background-dark font-display text-[#0e141b] dark:text-slate-200 h-screen overflow-hidden"
  >
    <div class="flex h-full w-full">
      <%- include('../partials/siderbar_estudiante', { active: active, user:
      user }) %>

        <div class="flex flex-1 flex-col">
          <div class="layout-container flex h-full grow flex-col">
            <div
              class="flex flex-1 justify-center py-5 sm:px-4 md:px-10 lg:px-20 xl:px-40"
            >
              <div
                class="layout-content-container flex flex-col w-full max-w-[960px] flex-1"
              >
                <main class="flex-1 h-full overflow-y-auto">
                  <div class="flex flex-wrap justify-between gap-3 p-4">
                    <div class="flex min-w-72 flex-col gap-3">
                      <p
                        class="text-slate-900 dark:text-white text-4xl font-black leading-tight tracking-[-0.033em]"
                      >
                        Mis Actividades
                      </p>
                      <p
                        class="text-slate-500 dark:text-slate-400 text-base font-normal leading-normal mt-2"
                      >
                        Aquí puedes ver todas tus lecturas asignadas.
                      </p>
                    </div>
                  </div>

                  <div class="pb-3 mt-4">
                    <div
                      class="flex border-b border-[#d0dbe7] dark:border-slate-700 px-4 gap-8"
                    >
                      <a
                        id="tab-pendientes"
                        href="#pendientes"
                        class="tab-link flex items-center justify-center gap-2 border-b-[3px] pb-[13px] pt-4 cursor-pointer"
                      >
                        <span class="material-symbols-outlined text-lg"
                          >pending_actions</span
                        >
                        <p class="text-sm font-bold...">
                          Pendientes (<%= pendientes.length %>)
                        </p>
                      </a>
                      <a
                        id="tab-completadas"
                        href="#completadas"
                        class="tab-link flex items-center justify-center gap-2 border-b-[3px] pb-[13px] pt-4 cursor-pointer"
                      >
                        <span class="material-symbols-outlined text-lg"
                          >task_alt</span
                        >
                        <p class="text-sm font-bold...">
                          Completadas (<%= completadas.length %>)
                        </p>
                      </a>
                    </div>
                  </div>

                  <div
                    id="section-pendientes"
                    class="tab-content grid grid-cols-1 md:grid-cols-2 gap-2"
                  >
                    <% if (pendientes.length === 0) { %>
                    <p class="col-span-full text-center text-slate-500 py-8">
                      ¡No tienes actividades pendientes!
                    </p>
                    <% } %>
                    <% pendientes.forEach(actividad => { %>
                    <div class="p-4 @container">
                      <div
                        class="flex flex-col items-stretch justify-start rounded-xl @xl:flex-row @xl:items-start bg-white dark:bg-slate-800/50 shadow-sm hover:shadow-lg transition-shadow duration-300 border border-transparent dark:border-slate-700/50"
                      >
                        <div
                          class="w-full @xl:w-1/3 h-40 @xl:h-auto bg-center bg-no-repeat bg-cover rounded-t-lg @xl:rounded-l-lg @xl:rounded-r-none"
                          style="
                            background-image: url(&quot;<%= actividad.imagenUrl %>&quot;);
                          "
                        ></div>
                        <div
                          class="flex w-full min-w-72 grow flex-col items-stretch justify-start gap-3 p-4"
                        >
                          <p
                            class="text-[#0e141b] dark:text-slate-50 text-lg font-bold..."
                          >
                            <%= actividad.titulo %>
                          </p>
                          <div class="flex flex-wrap items-center gap-2">
                            <span
                              class="text-xs font-medium text-blue-800 bg-blue-100..."
                              ><%= actividad.tema %></span
                            >
                            <span
                              class="text-xs font-medium text-amber-800 bg-amber-100..."
                              ><%= actividad.dificultad %></span
                            >
                          </div>
                          <div
                            class="flex items-end gap-3 justify-between mt-auto pt-3"
                          >
                            <a
                              href="/actividad/<%= actividad._id %>"
                              class="flex w-full sm:w-auto min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-6 bg-primary text-slate-50 text-sm font-medium..."
                            >
                              <span class="truncate">Comenzar</span>
                            </a>
                          </div>
                        </div>
                      </div>
                    </div>
                    <% }) %>
                  </div>

                  <div
                    id="section-completadas"
                    class="tab-content mt-10 grid grid-cols-1 md:grid-cols-2 gap-2 hidden"
                  >
                    <% if (completadas.length > 0) { %>
                    <h2
                      class="col-span-full text-2xl font-bold text-slate-800 dark:text-slate-200 mb-4 px-4"
                    >
                      Actividades Completadas
                    </h2>
                    <% } else { %>
                    <p class="col-span-full text-center text-slate-500 py-8">
                      Aún no has completado ninguna actividad.
                    </p>
                    <% } %>

                    <% completadas.forEach(actividad => { %>
                    <div class="p-4 @container opacity-70">
                      <div
                        class="flex flex-col items-stretch justify-start rounded-xl @xl:flex-row @xl:items-start bg-white dark:bg-slate-800/50 shadow-sm border border-transparent dark:border-slate-700/50"
                      >
                        <div
                          class="w-full @xl:w-1/3 h-40 @xl:h-auto bg-center bg-no-repeat bg-cover rounded-t-lg @xl:rounded-l-lg @xl:rounded-r-none"
                          style="
                            background-image: url(&quot;<%= actividad.imagenUrl %>&quot;);
                          "
                        ></div>
                        <div
                          class="flex w-full min-w-72 grow flex-col items-stretch justify-start gap-3 p-4"
                        >
                          <p
                            class="text-[#0e141b] dark:text-slate-50 text-lg font-bold..."
                          >
                            <%= actividad.titulo %>
                          </p>
                          <div class="flex flex-wrap items-center gap-2">
                            <span
                              class="text-xs font-medium text-blue-800 bg-blue-100..."
                              ><%= actividad.tema %></span
                            >
                            <span
                              class="text-xs font-medium text-amber-800 bg-amber-100..."
                              ><%= actividad.dificultad %></span
                            >
                          </div>
                          <div class="mt-auto pt-3">
                            <% const porcentaje =
                            Math.round((actividad.progreso.puntajeObtenido /
                            actividad.progreso.puntajeTotalPosible) * 100); %>
                            <p
                              class="text-lg font-bold text-green-600 dark:text-green-400"
                            >
                              ¡Completada! Nota:
                              <%= porcentaje %>% (<%=
                              actividad.progreso.puntajeObtenido %>/<%=
                              actividad.progreso.puntajeTotalPosible %>
                              pts)
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                    <% }) %>
                  </div>
                </main>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
